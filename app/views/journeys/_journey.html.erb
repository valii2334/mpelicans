<meta name="description" content="<%= @journey.meta_description_content %>">

<div class="row">
  <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 col-12">
    <div class="row" data-controller="lightbox"> 
      <div class="col-12">
        <% if current_user && can?(:edit, @journey) %>
          <%= link_to '+ New Stop', new_journey_journey_stop_path(@journey), class: 'btn btn-primary  float-end mt-n1' %>
        <% end %>
      </div>
    <div>

    <div class="row">
      <div class="col-12">
        <h1 id="journey-title"><%= @journey.title %></h1>
      </div>
    </div>

    <br>

    <div class="row">
      <div class="col-12">
        <%= link_to pelican_path(@journey.user.username), class: 'card-link' do %>
          <%= render partial: 'pelicans/profile_image', locals: { user: @journey.user } %>
          <b><%= @journey.user.username %></b>
        <% end %>
      </div>
    </div>

    <br>

    <% if current_user && can?(:edit, @journey) %>
      <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-body">
                Privacy: <%= @journey.access_type.split('_').first %>.
            </div>
          </div>
        </div>
      </div>
    <% end %>

    <% unless @journey.description.body.to_plain_text.blank? %>
      <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-body">
              <div id="journey-description">
                <%= @journey.description %>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>

    <% if !Rails.env.test? && @journey.pins.present? %>
      <%= render partial: 'shared/map', locals: { pins: @journey.pins.to_json } %>
    <% end %>

    <div class="row">
      <% @journey.journey_stops.each_with_index do |journey_stop, index| %>
        <%= render partial: 'journey_stops/journey_stop_card', locals: { journey_stop: journey_stop, index: index } %>
      <% end %>
    </div>

    <div class="row">
      <div class="col-12">
        <div class="card">
          <%= render partial: 'shared/images_grid', locals: { thumbnail_image_urls: @journey.images_urls(variant: :thumbnail), image_urls: @journey.images_urls(variant: :max), object_id: @journey.id }%>
        </div>
      </div>
    </div>

    <% if current_user && can?(:destroy, @journey) %>
      <div class="row">
        <div class="col-12">
          <%= link_to 'Delete Journey', journey_path(@journey), method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger float-end mt-n1' %>
        </div>
      </div>
    <% end %>
  </div>
</div>

